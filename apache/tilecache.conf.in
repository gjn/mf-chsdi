# %GENERATED_WARNING%

# Uncomment the following lines if you need to use TileCache
# through mod_python.
# Note that this is not recommended since mod_python is not
# maintained anymore (mod_wsgi is the way to go).
# You can use the TileCache controller available in your project
# application instead.
#


# GOODIP Stuff

SetEnvIF X-FORWARDED-FOR ^128.179.66.4$  GOODIP # camptocamp gateway (exactly...)
SetEnvIF X-FORWARDED-FOR ^193.5.216      GOODIP # swisstopo network behind proxy? (contains...)
SetEnvIf X-FORWARDED-FOR ^160.92.125.32$ GOODIP # IGN Proxy

RewriteCond %{HTTP_HOST} ^tilecache*
RewriteRule ^/(.*)$  /${vars:instanceid}/tilecache/$1


<Location /${vars:instanceid}/tilecache>
    SetHandler python-program
    PythonHandler TileCache.Service
    PythonOption TileCacheConfig ${buildout:directory/tilecache/tilecache.cfg}

    Allow from all
    # Settings for AWS
    Allow from env=GOODIP
    # Setting for test server
    Allow from  10.131.50. 10.131.51.     # swisstopo net
    Allow from 193.5.216.100 193.5.216.70 # BIT proxy
    Allow from 160.92.125.32              # IGN proxy

    ExpiresActive on
    ExpiresDefault "now plus 1 year"
    Header set Cache-Control "public"
    Header unset Etag
</Location>
