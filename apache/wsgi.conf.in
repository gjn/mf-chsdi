RewriteEngine On
ExpiresActive On

RedirectMatch ^/$ /doc/build/

# non cached urls:
RewriteRule ^%INSTANCE_ID%/(build|lib|GeoAdmin.ux|tests|doc)/(.*)$  %PROJECT_DIR%/chsdi/public/$1/$2

# cached urls:
RewriteRule ^/[0-9a-fA-F]*%INSTANCE_ID%/(build|lib|GeoAdmin.ux)/(.*)$  %PROJECT_DIR%/chsdi/public/$1/$2
<LocationMatch /[0-9a-fA-F]*%INSTANCE_ID%/(build|lib|GeoAdmin.ux)>
    ExpiresDefault "now plus 1 year"
    Header merge Cache-Control "public"

    Header set X-Powered-By http://imgs.xkcd.com/comics/python.png
</LocationMatch>

# web services:
WSGIScriptAlias %INSTANCE_ID% %PROJECT_DIR%/chsdi.wsgi
# never cache the api loader
<Location %INSTANCE_ID%/loader.js>
    ExpiresDefault "access"
    Header merge Cache-Control "no-cache"
    Header unset ETag
    Header unset Last-Modified
</Location>
