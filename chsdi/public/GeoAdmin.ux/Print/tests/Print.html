<!DOCTYPE html>
<html debug="true">
  <head>
    <script type="text/javascript" src="../../../lib/ext/Ext/adapter/ext/ext-base.js"></script>
    <script type="text/javascript" src="../../../lib/ext/Ext/ext-all-debug.js"></script>
    <script type="text/javascript" src="../../../lib/openlayers/lib/OpenLayers.js"></script>
    <script type="text/javascript" src="../../../lib/geoext/lib/GeoExt.js"></script>
    <script type="text/javascript" src="../../GeoAdmin.js"></script>
    <script type="text/javascript" src="../../Map/lib/VoidLayer.js"></script>
    <script type="text/javascript" src="../../Map/lib/Layers.js"></script>
    <script type="text/javascript" src="../../Map/lib/OverviewMap.js"></script>
    <script type="text/javascript" src="../../Map/lib/Map.js"></script>
    <script type="text/javascript" src="../../../lib/geoext.ux/ux/SimplePrint/lib/GeoExt.ux/SimplePrint.js"></script>
    <script type="text/javascript" src="../lib/Print.js"></script>


    <script type="text/javascript">
        printCapabilities={"scales":[{"name":"1:5,000","value":"5000"},{"name":"1:10,000","value":"10000"},{"name":"1:20,000","value":"20000"},{"name":"1:25,000","value":"25000"},{"name":"1:50,000","value":"50000"},{"name":"1:100,000","value":"100000"},{"name":"1:200,000","value":"200000"},{"name":"1:500,000","value":"500000"},{"name":"1:1,000,000","value":"1000000"},{"name":"1:2,500,000","value":"2500000"}],"dpis":[{"name":"150","value":"150"}],"layouts":[{"name":"A4 paysage","map":{"width":762,"height":453},"rotation":false}],"printURL":"http://map.geo.admin.ch/print/print.pdf","createURL":"http://map.geo.admin.ch/print/create.json"};
       
        function test_initComponent(t) {
            t.plan(4);

            var map = new GeoAdmin.Map();
            var mapPanel = new GeoExt.MapPanel({
                region: 'center',
                map: map 
            }); 
            var print = new GeoAdmin.Print({
                text: OpenLayers.i18n('print map (panel)'),
                printPanelOptions: {
                    renderTo: 'print',
                    mapPanel: mapPanel
                }
            });
        
            new Ext.Panel({
                renderTo: "map",
                layout: "border",
                height: 400,
                width: 600,
                items: [
                    mapPanel
                ],
                bbar: [print]
            }); 
            print.show(); // as if print button has been clicked 
            
            t.ok(print.printPanel.printExtent, "PrintExtent created.");
            t.ok(print.printPanel.printExtent.map == mapPanel.map, "PrintExtent added to map.");
            t.ok(print.printPanel.printPage, "PrintPage assigned.");
            t.eq(print.printPanel.items.getCount(), 1, "Form has one items.");
            
            print.printPanel.destroy();
            mapPanel.destroy();
        }

    </script>
  <body>
    <div id="map"></div>
    <div id="print"></div>
  </body>
</html>
