<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
      <script type="text/javascript" src="../../../lib/ext/Ext/adapter/ext/ext-base.js"></script>
      <script type="text/javascript" src="../../../lib/ext/Ext/ext-all.js"></script>
      <script type="text/javascript" src="../../../lib/openlayers/lib/OpenLayers.js"></script>
      <script type="text/javascript" src="../../../lib/geoext/lib/GeoExt.js"></script>
      <script type="text/javascript" src="../../../GeoAdmin.ux/GeoAdmin.js"></script>
      <script type="text/javascript" src="../lib/GeoCatSearch.js"></script>
      <script type="text/javascript">
        function test_ctor(t) {
            t.plan(2);

            // test
            var c = new GeoAdmin.GeoCatSearch();
            t.ok(c instanceof GeoAdmin.GeoCatSearch,
                 "ctor creates an instance of GeoCatSearch");
            t.eq(c.items.getCount(), 2, "ctor creates two items");
        }

        function test_query(t) {
            t.plan(2);

            // set up
            var c = new GeoAdmin.GeoCatSearch({ url:"foo"});

            // test
            var query = "bar", log = {};
            c.store.proxy.on({beforeload: function(p, params) {
                log.q = params.q;
                return false; // stop the request
            }});
            c.searchGeoCat(query);
            t.eq(log.q, query, "query param is correct");
            t.eq(Ext.WindowMgr.getActive().id, c.searchResultsWindow.id, "Search result window is shown");
        }
      </script>
  </head>
  <body>
    <div style="width: 100px; height: 600px" id="map"></div>
  </body>
</html>
